<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ride Booking App</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f9;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #1e88e5;
            margin-bottom: 20px;
        }
        input[type="text"] {
            width: calc(100% - 20px);
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
        }
        .map-placeholder {
            width: 100%;
            height: 200px;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border-radius: 8px;
            color: #555;
            font-weight: bold;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
        }
        .map-large {
            height: 350px; /* Larger map for the in-ride view */
        }
        .vehicle-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        .vehicle-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            background-color: #f9f9f9;
        }
        .vehicle-card:hover {
            border-color: #1e88e5;
            background-color: #e3f2fd;
        }
        .vehicle-card.selected {
            border-color: #1e88e5;
            background-color: #e3f2fd;
            box-shadow: 0 0 10px rgba(30, 136, 229, 0.4);
        }
        .vehicle-info {
            display: flex;
            flex-direction: column;
        }
        .vehicle-name {
            font-weight: bold;
            font-size: 1.1em;
            color: #333;
        }
        .vehicle-price {
            font-size: 1.2em;
            font-weight: bold;
            color: #28a745;
            text-align: right;
        }
        .vehicle-eta {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 4px;
        }
        .book-button {
            width: 100%;
            padding: 15px;
            background-color: #1e88e5;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s, opacity 0.3s;
        }
        .book-button:disabled {
            background-color: #90caf9;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* --- NEW STYLES FOR IN-RIDE VIEW --- */
        #in-ride-view {
            text-align: center;
        }
        .ride-status-card {
            background-color: #e8f5e9;
            border: 1px solid #c8e6c9;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .status-message {
            font-size: 1.5em;
            font-weight: bold;
            color: #388e3c;
            margin-bottom: 20px;
        }
        .driver-info {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
            margin: 15px 0;
            text-align: left;
        }
        .driver-photo-placeholder {
            width: 50px;
            height: 50px;
            background-color: #bbdefb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        .driver-photo-placeholder::after {
            content: 'üë§';
        }
        .ride-summary {
            text-align: left;
            margin-bottom: 20px;
            font-size: 0.95em;
        }
        .ride-summary p {
            margin: 5px 0;
        }
        .button-secondary {
            padding: 10px 20px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .button-secondary:hover {
            background-color: #d32f2f;
        }

    </style>
</head>
<body>

<div class="container">
    <h1>üöï Ride Booking</h1>

    <div id="booking-view">
        <div class="map-placeholder">
            <p>üó∫Ô∏è Map Preview</p>
        </div>

        <input type="text" id="pickup-input" placeholder="üìç Enter Pickup Location" oninput="checkBookingReadiness()">
        <input type="text" id="dropoff-input" placeholder="üèÅ Enter Dropoff Location" oninput="checkBookingReadiness()">

        <h2>Select Your Ride</h2>
        <div id="vehicle-options-container" class="vehicle-options" role="radiogroup">
            </div>

        <button id="book-ride-button" class="book-button" disabled onclick="bookRide()">
            Please enter locations and select a vehicle
        </button>
    </div>

    <div id="in-ride-view" style="display: none;">
        <div class="map-placeholder map-large">
            <p>üó∫Ô∏è **Live Ride Map**</p>
            <p>Driver is approaching. Estimated time: 3 minutes</p>
        </div>
        <div class="ride-status-card">
            <h2>Your Ride Status</h2>
            <div id="ride-status-message" class="status-message">Driver Confirmed!</div>

            <div class="driver-info">
                <div class="driver-photo-placeholder"></div>
                <div>
                    <p><strong>Driver:</strong> <span id="driver-name">Sarah J.</span></p>
                    <p><strong>Vehicle:</strong> <span id="vehicle-details">Black Sedan ‚Ä¢ ABC-123</span></p>
                    <p><strong>Rating:</strong> ‚≠êÔ∏è 4.9</p>
                </div>
            </div>

            <div class="ride-summary">
                <p><strong>From:</strong> <span id="summary-pickup"></span></p>
                <p><strong>To:</strong> <span id="summary-dropoff"></span></p>
            </div>

            <button id="cancel-ride-btn" class="button-secondary" onclick="cancelRide()">Cancel Ride</button>
        </div>
    </div>
</div>

<script>
    // Mock Data for Vehicles
    const vehicles = [
        { id: 'standard_sedan', name: 'Standard Sedan', price: 15.50, category: 'Standard', eta: 3 },
        { id: 'comfort_suv', name: 'Comfort SUV', price: 25.00, category: 'Comfort', eta: 5 },
        { id: 'electric_eco', name: 'Electric Eco', price: 18.00, category: 'Electric', eta: 4 },
        { id: 'lux_bugatti', name: 'Bugatti Veyron', price: 150.00, category: 'Exotic Sportscar', eta: 7 },
        { id: 'lux_lamborghini', name: 'Lamborghini Hurac√°n', price: 120.00, category: 'Exotic Sportscar', eta: 8 }
    ];

    let selectedVehicleId = null;

    /**
     * Renders the vehicle options dynamically.
     * This function is also used to reset the selection state.
     */
    function renderVehicles() {
        const container = document.getElementById('vehicle-options-container');
        container.innerHTML = ''; // Clear previous content

        vehicles.forEach(vehicle => {
            const isSelected = vehicle.id === selectedVehicleId;
            const card = document.createElement('div');
            card.className = `vehicle-card ${isSelected ? 'selected' : ''}`;
            card.setAttribute('data-id', vehicle.id);
            card.setAttribute('role', 'radio');
            card.setAttribute('aria-checked', isSelected ? 'true' : 'false');
            card.onclick = () => selectVehicle(vehicle.id);

            card.innerHTML = `
                <div class="vehicle-info">
                    <div class="vehicle-name">${vehicle.name}</div>
                    <div class="vehicle-eta">ETA: ${vehicle.eta} min</div>
                </div>
                <div class="vehicle-price">$${vehicle.price.toFixed(2)}</div>
            `;
            container.appendChild(card);
        });
        checkBookingReadiness();
    }

    /**
     * Selects a vehicle and updates the UI.
     * @param {string} id The ID of the selected vehicle.
     */
    function selectVehicle(id) {
        selectedVehicleId = id;
        renderVehicles(); // Re-render to update the 'selected' state
    }

    /**
     * Checks if the required inputs are filled and enables/disables the Book Ride button.
     */
    function checkBookingReadiness() {
        const pickup = document.getElementById('pickup-input').value;
        const dropoff = document.getElementById('dropoff-input').value;
        const button = document.getElementById('book-ride-button');

        const isReady = pickup && dropoff && selectedVehicleId;
        button.disabled = !isReady;

        if (isReady) {
            const selectedVehicle = vehicles.find(v => v.id === selectedVehicleId);
            button.textContent = `Book ${selectedVehicle.name} for $${selectedVehicle.price.toFixed(2)}`;
        } else {
            button.textContent = 'Please enter locations and select a vehicle';
        }
    }

    /**
     * Handles the ride booking process.
     * NEW: Transitions to the In-Ride View on success.
     */
    function bookRide() {
        const pickup = document.getElementById('pickup-input');
        const dropoff = document.getElementById('dropoff-input');

        if (pickup.value && dropoff.value && selectedVehicleId) {
            
            // --- 1. Successful Booking Simulation ---
            console.log(`Booking confirmed: ${selectedVehicleId} from ${pickup.value} to ${dropoff.value}`);

            // Get the selected vehicle object to populate the details
            const selectedVehicle = vehicles.find(v => v.id === selectedVehicleId);
            
            // --- 2. Transition Views ---
            document.getElementById('booking-view').style.display = 'none';
            document.getElementById('in-ride-view').style.display = 'block';
            
            // --- 3. Populate In-Ride View Details ---
            document.getElementById('driver-name').textContent = 'Sarah J.'; // Mock data
            document.getElementById('vehicle-details').textContent = `${selectedVehicle.name} ‚Ä¢ ABC-123`; // Mock data
            document.getElementById('summary-pickup').textContent = pickup.value;
            document.getElementById('summary-dropoff').textContent = dropoff.value;

            // --- 4. Start Ride Simulation (Dynamic Status Updates) ---
            simulateRide();

        } else {
            alert('Please enter both locations and select a vehicle to book.');
        }
    }

    /**
     * NEW FUNCTION: Simulates the ride progression and updates the status message.
     */
    function simulateRide() {
        const statusElement = document.getElementById('ride-status-message');
        const mapPlaceholder = document.querySelector('#in-ride-view .map-placeholder p');
        
        const stages = [
            { message: 'Driver is arriving in 5 min.', mapText: 'Driver is approaching. Estimated time: 3 minutes', delay: 5000, color: '#ff9800' },
            { message: 'Driver has arrived at pickup location! Step outside.', mapText: 'Driver is at your location!', delay: 10000, color: '#2196f3' },
            { message: 'You are on the way to your destination.', mapText: 'On the road. Route progress: 60%', delay: 15000, color: '#1e88e5' },
            { message: 'You have arrived! Trip is complete.', mapText: 'Trip Complete. Thank you for riding!', delay: 5000, color: '#388e3c' }
        ];

        let currentStage = 0;

        function nextStage() {
            if (currentStage < stages.length) {
                const stage = stages[currentStage];
                statusElement.textContent = stage.message;
                statusElement.style.color = stage.color;
                mapPlaceholder.innerHTML = `üó∫Ô∏è **Live Ride Map**<br>${stage.mapText}`;

                currentStage++;
                setTimeout(nextStage, stage.delay);
            } else {
                // After the trip is complete, automatically transition back to booking view after a delay
                setTimeout(() => {
                    alert('Your ride is complete! We hope you enjoyed it.');
                    // Reset to booking view
                    document.getElementById('in-ride-view').style.display = 'none';
                    document.getElementById('booking-view').style.display = 'block';
                    
                    // Clear state
                    document.getElementById('pickup-input').value = '';
                    document.getElementById('dropoff-input').value = '';
                    selectedVehicleId = null;
                    renderVehicles();
                }, 5000);
            }
        }

        nextStage();
    }

    /**
     * Handles the cancel ride button.
     */
    function cancelRide() {
        if(confirm('Are you sure you want to cancel your ride?')) {
            // Reset to booking view
            document.getElementById('in-ride-view').style.display = 'none';
            document.getElementById('booking-view').style.display = 'block';
            
            // Clear state
            document.getElementById('pickup-input').value = '';
            document.getElementById('dropoff-input').value = '';
            selectedVehicleId = null;
            renderVehicles();
            alert('Your ride has been cancelled.');
        }
    }

    // Initialize the vehicle options when the page loads
    window.onload = renderVehicles;
</script>

</body>
</html>