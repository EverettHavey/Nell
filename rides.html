<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ride Booking App</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f9;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative; 
        }
        h1 {
            text-align: center;
            color: #1e88e5;
            margin-bottom: 20px;
        }
        input[type="text"] {
            width: calc(100% - 20px);
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
        }
        .map-placeholder {
            width: 100%;
            height: 200px;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border-radius: 8px;
            color: #555;
            font-weight: bold;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
        }
        .map-large {
            height: 350px; 
        }
        .vehicle-options, .payment-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        .vehicle-card, .payment-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            background-color: #f9f9f9;
        }
        .vehicle-card:hover, .payment-card:hover {
            border-color: #1e88e5;
            background-color: #e3f2fd;
        }
        .vehicle-card.selected, .payment-card.selected {
            border-color: #1e88e5;
            background-color: #e3f2fd;
            box-shadow: 0 0 10px rgba(30, 136, 229, 0.4);
        }
        .vehicle-info, .payment-info {
            display: flex;
            flex-direction: column;
        }
        .vehicle-name, .payment-name {
            font-weight: bold;
            font-size: 1.1em;
            color: #333;
        }
        .vehicle-price {
            font-size: 1.2em;
            font-weight: bold;
            color: #28a745;
            text-align: right;
        }
        .vehicle-eta {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 4px;
        }
        .book-button {
            width: 100%;
            padding: 15px;
            background-color: #1e88e5;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s, opacity 0.3s;
        }
        .book-button:disabled {
            background-color: #90caf9;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* --- NOTIFICATION STYLES --- */
        #notification-banner {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) translateY(-100%); 
            width: 90%;
            padding: 15px 20px;
            background-color: #4caf50; 
            color: white;
            text-align: center;
            font-weight: bold;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: transform 0.4s ease-out, opacity 0.4s ease-out;
        }
        #notification-banner.show {
            transform: translateX(-50%) translateY(0); 
            opacity: 1;
        }

        /* --- IN-RIDE VIEW STYLES --- */
        #in-ride-view {
            text-align: center;
        }
        .ride-status-card {
            background-color: #e8f5e9;
            border: 1px solid #c8e6c9;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .status-message {
            font-size: 1.5em;
            font-weight: bold;
            color: #388e3c;
            margin-bottom: 20px;
        }
        .driver-info {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            border-top: 1px solid #eee;
            border-bottom: 1px solid #eee;
            margin: 15px 0;
            text-align: left;
        }
        .driver-photo-placeholder {
            width: 50px;
            height: 50px;
            background-color: #bbdefb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        .driver-photo-placeholder::after {
            content: 'üë§';
        }
        .ride-summary {
            text-align: left;
            margin-bottom: 20px;
            font-size: 0.95em;
        }
        .ride-summary p {
            margin: 5px 0;
        }
        .button-secondary {
            padding: 10px 20px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .button-secondary:hover {
            background-color: #d32f2f;
        }

    </style>
</head>
<body>

<div class="container">
    <h1>üöï Ride Booking</h1>
    
    <div id="notification-banner">
        üéâ Ride Accepted! Driver is confirmed and arriving soon.
    </div>

    <div id="booking-view">
        <div class="map-placeholder">
            <p>üó∫Ô∏è Map Preview</p>
        </div>

        <input type="text" id="pickup-input" placeholder="üìç Enter Pickup Location" oninput="checkBookingReadiness()">
        <input type="text" id="dropoff-input" placeholder="üèÅ Enter Dropoff Location" oninput="checkBookingReadiness()">

        <h2>Select Your Ride</h2>
        <div id="vehicle-options-container" class="vehicle-options" role="radiogroup">
            </div>

        <h2>Payment Method</h2>
        <div id="payment-options-container" class="payment-options" role="radiogroup">
            </div>
        <button id="book-ride-button" class="book-button" disabled onclick="bookRide()">
            Please enter locations, select a vehicle, and a payment method
        </button>
    </div>

    <div id="in-ride-view" style="display: none;">
        <div class="map-placeholder map-large">
            <p>üó∫Ô∏è **Live Ride Map**</p>
            <p>Driver is approaching. Estimated time: 3 minutes</p>
        </div>
        <div class="ride-status-card">
            <h2>Your Ride Status</h2>
            <div id="ride-status-message" class="status-message">Driver Confirmed!</div>

            <div class="driver-info">
                <div class="driver-photo-placeholder"></div>
                <div>
                    <p><strong>Driver:</strong> <span id="driver-name"></span></p>
                    <p><strong>Vehicle:</strong> <span id="vehicle-details"></span></p>
                    <p><strong>Rating:</strong> ‚≠êÔ∏è <span id="driver-rating">4.9</span></p>
                    <p><strong>Payment:</strong> <span id="payment-summary"></span></p>
                </div>
            </div>

            <div class="ride-summary">
                <p><strong>From:</strong> <span id="summary-pickup"></span></p>
                <p><strong>To:</strong> <span id="summary-dropoff"></span></p>
            </div>

            <button id="cancel-ride-btn" class="button-secondary" onclick="cancelRide()">Cancel Ride</button>
        </div>
    </div>
</div>

<script>
    // --- MOCK DATA ---
    const vehicles = [
        { id: 'standard', name: 'Standard üöó', price: 15.00, category: 'Standard', eta: '10 min' },
        { id: 'xl', name: 'XL üöå', price: 37.50, category: 'XL', eta: '10 min' },
        { id: 'premium', name: 'Premium üíé', price: 70.00, category: 'Premium', eta: '10 min' },
        { id: 'luxury', name: 'Luxury ‚ú®', price: 125.00, category: 'Luxury', eta: '10 min' },
        { id: 'heli_ride', name: 'Heli-Ride üöÅ', price: 450.00, category: 'Unique', eta: '5 min' },
        
        { id: 'airplane', name: 'Airplane ‚úàÔ∏è', price: 2500.00, category: 'Unique', eta: '1 hour' },
        { id: 'ice_cream', name: 'Ice Cream üç¶', price: 36.00, category: 'Fun', eta: '35 min (slow stops!)' },
        { id: 'garbage_truck', name: 'Garbage Truck üöö', price: 49.50, category: 'Fun', eta: '45 min (many stops!)' },
        { id: 'fire_truck', name: 'Fire Truck üöí', price: 150.00, category: 'Fun', eta: '15 min (with sirens)' },
        { id: 'exotic', name: 'Exotic Sportscar üèéÔ∏è', price: 187.50, category: 'Luxury', eta: '8 min (if traffic allows)' },
        
        { id: 'golf_cart', name: 'Golf Cart ‚õ≥', price: 8.00, category: 'Budget', eta: '15 min' },
        { id: 'walk', name: 'Walk üö∂', price: 2.50, category: 'Budget', eta: '40 min' },
        { id: 'bike', name: 'Bike üö≤', price: 5.60, category: 'Budget', eta: '20 min' }
    ];

    const paymentMethods = [
        { id: 'visa', name: 'Visa **** 1234', icon: 'üí≥' },
        { id: 'paypal', name: 'PayPal (Primary)', icon: 'üí∞' },
        { id: 'cash', name: 'Cash', icon: 'üíµ' }
    ];
    // ----------------------------------------
    
    let selectedVehicleId = null;
    let selectedPaymentId = null;

    /**
     * Provides mock driver details based on the selected ride ID.
     */
    function getDriverDetails(vehicleId) {
        switch (vehicleId) {
            case 'standard':
            case 'xl':
                return { name: 'Sarah J.', rating: '4.9', plate: 'T-800' };
            case 'premium':
            case 'luxury':
                return { name: 'James B.', rating: '5.0', plate: 'L-007' };
            case 'heli_ride':
                return { name: 'Captain Viper', rating: '4.8', plate: 'H-911' };
            case 'airplane':
                return { name: 'Pilot Amelia', rating: '5.0', plate: 'F-14-J' };
            case 'ice_cream':
                return { name: 'Scoops M.', rating: '4.7', plate: 'I-C-3' };
            case 'garbage_truck':
                return { name: 'Refuse Rick', rating: '4.5', plate: 'G-ARB' };
            case 'fire_truck':
                return { name: 'Chief Blaze', rating: '4.9', plate: 'F-999' };
            case 'exotic':
                return { name: 'Racer Ken', rating: '4.9', plate: 'Z-010' };
            case 'golf_cart':
                return { name: 'Caddy Max', rating: '4.6', plate: 'G-OLF' };
            case 'walk':
                return { name: 'Speedy Sam', rating: '4.4', plate: 'N/A' };
            case 'bike':
                return { name: 'Wheels Willy', rating: '4.7', plate: 'B-ICY' };
            default:
                return { name: 'Driver D.', rating: '4.8', plate: 'X-777' };
        }
    }

    // --- VEHICLE SELECTION LOGIC ---

    function renderVehicles() {
        const container = document.getElementById('vehicle-options-container');
        container.innerHTML = ''; 

        vehicles.forEach(vehicle => {
            const isSelected = vehicle.id === selectedVehicleId;
            const card = document.createElement('div');
            card.className = `vehicle-card ${isSelected ? 'selected' : ''}`;
            card.setAttribute('data-id', vehicle.id);
            card.setAttribute('role', 'radio');
            card.setAttribute('aria-checked', isSelected ? 'true' : 'false');
            card.onclick = () => selectVehicle(vehicle.id);

            card.innerHTML = `
                <div class="vehicle-info">
                    <div class="vehicle-name">${vehicle.name}</div>
                    <div class="vehicle-eta">${vehicle.eta}</div>
                </div>
                <div class="vehicle-price">$${vehicle.price.toFixed(2)}</div>
            `;
            container.appendChild(card);
        });
        checkBookingReadiness();
    }

    function selectVehicle(id) {
        selectedVehicleId = id;
        renderVehicles();
    }

    // --- PAYMENT SELECTION LOGIC (NEW) ---

    function renderPaymentMethods() {
        const container = document.getElementById('payment-options-container');
        container.innerHTML = ''; 

        paymentMethods.forEach(method => {
            const isSelected = method.id === selectedPaymentId;
            const card = document.createElement('div');
            card.className = `payment-card ${isSelected ? 'selected' : ''}`;
            card.setAttribute('data-id', method.id);
            card.setAttribute('role', 'radio');
            card.setAttribute('aria-checked', isSelected ? 'true' : 'false');
            card.onclick = () => selectPaymentMethod(method.id);

            card.innerHTML = `
                <div class="payment-info">
                    <div class="payment-name">${method.icon} ${method.name}</div>
                </div>
            `;
            container.appendChild(card);
        });
        checkBookingReadiness();
    }

    function selectPaymentMethod(id) {
        selectedPaymentId = id;
        renderPaymentMethods();
    }

    // --- BOOKING LOGIC ---

    function checkBookingReadiness() {
        const pickup = document.getElementById('pickup-input').value;
        const dropoff = document.getElementById('dropoff-input').value;
        const button = document.getElementById('book-ride-button');

        const isReady = pickup && dropoff && selectedVehicleId && selectedPaymentId;
        button.disabled = !isReady;

        if (isReady) {
            const selectedVehicle = vehicles.find(v => v.id === selectedVehicleId);
            const buttonName = selectedVehicle.name.split(' ')[0]; 
            button.textContent = `Book ${buttonName} for $${selectedVehicle.price.toFixed(2)}`;
        } else {
            button.textContent = 'Please enter locations, select a vehicle, and a payment method';
        }
    }

    function showNotification() {
        const banner = document.getElementById('notification-banner');
        banner.classList.add('show');
        
        setTimeout(() => {
            banner.classList.remove('show');
        }, 3000);
    }

    function bookRide() {
        const pickup = document.getElementById('pickup-input');
        const dropoff = document.getElementById('dropoff-input');

        if (pickup.value && dropoff.value && selectedVehicleId && selectedPaymentId) {
            
            showNotification();

            const selectedVehicle = vehicles.find(v => v.id === selectedVehicleId);
            const selectedPayment = paymentMethods.find(p => p.id === selectedPaymentId);
            const driverInfo = getDriverDetails(selectedVehicleId);
            
            // Wait a moment for the notification to be visible before changing the view
            setTimeout(() => {
                
                // --- Transition Views ---
                document.getElementById('booking-view').style.display = 'none';
                document.getElementById('in-ride-view').style.display = 'block';
                
                // --- Populate In-Ride View Details ---
                document.getElementById('driver-name').textContent = driverInfo.name;
                document.getElementById('driver-rating').textContent = driverInfo.rating;
                document.getElementById('vehicle-details').textContent = `${selectedVehicle.name.replace(/(\s\w+)$/, '')} ‚Ä¢ ${driverInfo.plate}`; 
                document.getElementById('payment-summary').textContent = `${selectedPayment.icon} ${selectedPayment.name}`; // NEW
                document.getElementById('summary-pickup').textContent = pickup.value;
                document.getElementById('summary-dropoff').textContent = dropoff.value;

                // --- Start Ride Simulation ---
                simulateRide();

            }, 500); 

        } else {
            alert('Please enter both locations and select a vehicle and a payment method to book.');
        }
    }

    /**
     * Simulates the ride progression with realistic timing.
     */
    function simulateRide() {
        const statusElement = document.getElementById('ride-status-message');
        const mapPlaceholder = document.querySelector('#in-ride-view .map-placeholder p');
        
        // Stages are defined in milliseconds (1 second = 1000ms)
        const stages = [
            // Driver is confirmed and moving
            { message: 'Driver is arriving in 5 min.', mapText: 'Driver is approaching. Estimated time: 3 minutes', delay: 5000, color: '#ff9800' },
            // Driver arrives and waits for the user (The delay here is longer to give the user "3 minutes" to get to the car)
            { message: 'Driver has arrived at pickup! You have 3 minutes to board.', mapText: 'Driver is at your location! Please head to the curb.', delay: 180000, color: '#2196f3' }, // 3 minutes = 180,000ms
            // User boards and the ride starts
            { message: 'You are on the way to your destination.', mapText: 'On the road. Route progress: 60%', delay: 15000, color: '#1e88e5' },
            // Final arrival
            { message: 'You have arrived! Trip is complete.', mapText: 'Trip Complete. Thank you for riding!', delay: 5000, color: '#388e3c' }
        ];

        let currentStage = 0;

        function nextStage() {
            if (currentStage < stages.length) {
                const stage = stages[currentStage];
                statusElement.textContent = stage.message;
                statusElement.style.color = stage.color;
                mapPlaceholder.innerHTML = `üó∫Ô∏è **Live Ride Map**<br>${stage.mapText}`;

                currentStage++;
                setTimeout(nextStage, stage.delay);
            } else {
                // After the trip is complete, transition back to booking view after a delay
                setTimeout(() => {
                    alert('Your ride is complete! We hope you enjoyed it.');
                    // Reset to booking view
                    document.getElementById('in-ride-view').style.display = 'none';
                    document.getElementById('booking-view').style.display = 'block';
                    
                    // Clear state
                    document.getElementById('pickup-input').value = '';
                    document.getElementById('dropoff-input').value = '';
                    selectedVehicleId = null;
                    selectedPaymentId = null; // Reset payment
                    renderVehicles();
                    renderPaymentMethods();
                }, 5000);
            }
        }

        nextStage();
    }

    function cancelRide() {
        if(confirm('Are you sure you want to cancel your ride?')) {
            // Reset to booking view
            document.getElementById('in-ride-view').style.display = 'none';
            document.getElementById('booking-view').style.display = 'block';
            
            // Clear state
            document.getElementById('pickup-input').value = '';
            document.getElementById('dropoff-input').value = '';
            selectedVehicleId = null;
            selectedPaymentId = null; // Reset payment
            renderVehicles();
            renderPaymentMethods();
            alert('Your ride has been cancelled.');
        }
    }

    // Initialize all options when the page loads
    window.onload = () => {
        renderVehicles();
        renderPaymentMethods();
    };
</script>

</body>
</html>